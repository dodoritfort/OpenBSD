<!DOCTYPE html>
<html>
<head>
	<title>PacketFilter   Exemple(s) –  – </title>
	<link rel="stylesheet" type="text/css" href="/OpenBSD/assets/css/style.css" />
</head>
<body>

<section class="page-header">
	<h1 class="project-name">OpenBSD</h1>
	<h2 class="project-tagline">Le petit wiki OpenBSD</h2>   
	<a href="/OpenBSD/" class="btn">Menu</a>
</section>

<section class="main-content">
	<h1 id="packetfilter---exemples">PacketFilter - Exemple(s)</h1>

<h3 id="retrouvez-plus-darticles-sur-httpwikidodoritfortxyz"><strong>Retrouvez plus d’articles sur http://wiki.dodoritfort.xyz/</strong></h3>

<blockquote>
  <p>nano /etc/pf.conf</p>
</blockquote>

<div class="highlighter-rouge"><pre class="highlight"><code>#       $OpenBSD: pf.conf,v 1.54 2014/08/23 05:49:42 deraadt Exp $
#
# See pf.conf(5) and /etc/examples/pf.conf

###########
#  MACRO  #
###########
ext_if = "em0"                  # Interface
tun_if = "tun0"                 # Carte reseau VPN
port_ssh = "222"                # Port SSH
port_http = "{ www https }"     # Port(s) HTTP(S)
set skip on lo                  # Pas de filtre en local
set limit table-entries 400000  # Nombre d entree maximale dans une table

######################
#  TABLES Blacklist  #
######################
table &lt;ssh_abuse&gt; persist       # Table pour le SSH
table &lt;http_abuse&gt; persist      # Table pour le HTTP

#####################################################
#  Protection contre l'usurpation de l'adresse IP   #
#####################################################
block in quick from urpf-failed
antispoof for $ext_if

block return    # block stateless traffic
pass            # establish keep-state

# By default, do not permit remote connections to X11
block return in on ! lo0 proto tcp to port 6000:6010

###########################
#  SSH - Anti BruteForce  #
###########################
block in log quick proto tcp from &lt;ssh_abuse&gt; to any port $port_ssh
pass in on $ext_if proto tcp to any port $port_ssh flags S/SA modulate state \
        (max-src-conn 3, max-src-conn-rate 3/60, overload &lt;ssh_abuse&gt; flush global)

################################
#  HTTP(S) -  Anti BruteForce  #
################################
block in log quick proto tcp from &lt;http_abuse&gt; to any port $port_http
pass in on $ext_if proto tcp to any port $port_http flags S/SA modulate state \
        (max-src-conn 100, max-src-conn-rate 40/5, overload &lt;http_abuse&gt; flush)

#########
#  VPN  #
#########
pass in quick on $tun_if synproxy state
pass out on $ext_if from 10.8.0.0/24 to any nat-to ($ext_if)
</code></pre>
</div>

<p>Documentation : <a href="http://man.openbsd.org/pf.conf">http://man.openbsd.org/pf.conf</a></p>

<h3 id="retrouvez-plus-darticles-sur-httpwikidodoritfortxyz-1"><strong>Retrouvez plus d’articles sur http://wiki.dodoritfort.xyz/</strong></h3>

</section>

<section class="page-footer">
	<footer class="site-footer"> 
	<span class="site-footer-owner"><a href="https://github.com/dodoritfort/OpenBSD/">OpenBSD</a> is maintained by <a href="https://github.com/dodoritfort">dodoritfort</a>.</span>
	<span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
	</footer>
</section>

</body>
</html>